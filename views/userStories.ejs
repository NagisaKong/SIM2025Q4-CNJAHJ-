<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Stories | CSR Volunteer Matching Platform</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <header class="top-bar">
      <div class="top-bar__info">
        <h1>User Story Catalogue</h1>
        <p>
          Signed in as <strong><%= currentUser.displayName %> (<%= currentUser.role %>)</strong>
        </p>
      </div>
      <nav class="top-bar__nav" aria-label="Primary">
        <a class="button button--ghost" href="/dashboard">Dashboard</a>
        <form class="top-bar__logout" method="post" action="/logout">
          <button type="submit">Sign Out</button>
        </form>
      </nav>
    </header>

    <% const flashMessage = typeof flash !== 'undefined' ? flash : null; %>
    <% if (flashMessage) { %>
      <div class="flash flash--<%= flashMessage.type %>">
        <p><%= flashMessage.message %></p>
      </div>
    <% } %>

    <main class="content">
      <section class="section" aria-labelledby="user-story-overview">
        <h2 id="user-story-overview">Platform User Stories</h2>
        <p>
          Explore every high-level scenario that the platform must support across the four roles. These stories serve as a
          reference for feature validation and prioritisation during development and testing.
        </p>
      </section>

      <% storiesByRole.forEach((group) => { %>
        <section class="section" aria-labelledby="story-<%= group.role.replace(/\s+/g, '-').toLowerCase() %>">
          <h2 id="story-<%= group.role.replace(/\s+/g, '-').toLowerCase() %>"><%= group.role %></h2>
          <ul class="story-list">
            <% group.stories.forEach((story) => { %>
              <li>
                <article class="story-card">
                  <h3><%= story.action.charAt(0).toUpperCase() + story.action.slice(1) %></h3>
                  <p><%= story.statement %></p>
                </article>
              </li>
            <% }) %>
          </ul>
        </section>
      <% }) %>
    </main>
  </body>
</html>
